Thanks go to the following people for there patches:
@ghauerberg
